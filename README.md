## 1. AdaptiveResEncoder

'
encode_weight = torch.zeros((num_encoder_layers, d_model), device='cuda')
encode_weight[-1, :] = torch.ones((d_model), device='cuda')
self.encode_weight = nn.Parameter(encode_weight, requires_grad=True)
...
for i in range(6):
            mem += inter_mem[i] * self.encode_weight[i]
'

Compare with DeTr

DeTr: Epoch 0:"train_lr": 9.999999999999342e-05, "train_class_error": 89.00132779228738, "train_loss": 25.428831253216895, "train_loss_bbox": 1.141616935950595, "train_loss_bbox_0": 1.1871701720376293, "train_loss_bbox_1": 1.1554074858948267, "train_loss_bbox_2": 1.1439687113450978, "train_loss_bbox_3": 1.137943878802128, "train_loss_bbox_4": 1.1363896374385078, "train_loss_ce": 1.5075451776998126, "train_loss_ce_0": 1.5827832080391577, "train_loss_ce_1": 1.545520452064869, "train_loss_ce_2": 1.5272149658112815, "train_loss_ce_3": 1.5174654086656643, "train_loss_ce_4": 1.512690750325655, "train_loss_giou": 1.5496716783805327, "train_loss_giou_0": 1.5780433469907547, "train_loss_giou_1": 1.559824980988905, "train_loss_giou_2": 1.5517085842884981, "train_loss_giou_3": 1.5462578174807293, "train_loss_giou_4": 1.5476080747200298, "train_cardinality_error_unscaled": 7.935445413961039, "train_cardinality_error_0_unscaled": 7.70012344426407, "train_cardinality_error_1_unscaled": 7.736556412337662, "train_cardinality_error_2_unscaled": 7.717244994588745, "train_cardinality_error_3_unscaled": 7.795522186147186, "train_cardinality_error_4_unscaled": 7.856246617965368, "train_class_error_unscaled": 89.00132779228738, "train_loss_bbox_unscaled": 0.2283233871030343, "train_loss_bbox_0_unscaled": 0.23743403444542385, "train_loss_bbox_1_unscaled": 0.2310814970249544, "train_loss_bbox_2_unscaled": 0.2287937422762766, "train_loss_bbox_3_unscaled": 0.22758877592249996, "train_loss_bbox_4_unscaled": 0.22727792757236726, "train_loss_ce_unscaled": 1.5075451776998126, "train_loss_ce_0_unscaled": 1.5827832080391577, "train_loss_ce_1_unscaled": 1.545520452064869, "train_loss_ce_2_unscaled": 1.5272149658112815, "train_loss_ce_3_unscaled": 1.5174654086656643, "train_loss_ce_4_unscaled": 1.512690750325655, "train_loss_giou_unscaled": 0.7748358391902663, "train_loss_giou_0_unscaled": 0.7890216734953773, "train_loss_giou_1_unscaled": 0.7799124904944525, "train_loss_giou_2_unscaled": 0.7758542921442491, "train_loss_giou_3_unscaled": 0.7731289087403647, "train_loss_giou_4_unscaled": 0.7738040373600149, "test_class_error": 80.61580662818471, "test_loss": 28.39839132272514, "test_loss_bbox": 1.1101688678097572, "test_loss_bbox_0": 2.0522844032117518, "test_loss_bbox_1": 1.7690094071588698, "test_loss_bbox_2": 1.4350026625736503, "test_loss_bbox_3": 1.311189791958803, "test_loss_bbox_4": 1.1831550450082038, "test_loss_ce": 1.370138221865247, "test_loss_ce_0": 1.4795395280145536, "test_loss_ce_1": 1.463806616272896, "test_loss_ce_2": 1.4175632497307602, "test_loss_ce_3": 1.3968758446395777, "test_loss_ce_4": 1.383345760737255, "test_loss_giou": 1.5733277395272711, "test_loss_giou_0": 2.2133696329821446, "test_loss_giou_1": 1.9855036074948158, "test_loss_giou_2": 1.8301344411388325, "test_loss_giou_3": 1.7539237532646033, "test_loss_giou_4": 1.6700529771245969, "test_cardinality_error_unscaled": 13.492834394904458, "test_cardinality_error_0_unscaled": 18.508757961783438, "test_cardinality_error_1_unscaled": 19.818471337579616, "test_cardinality_error_2_unscaled": 17.193869426751593, "test_cardinality_error_3_unscaled": 15.385350318471337, "test_cardinality_error_4_unscaled": 12.799164012738853, "test_class_error_unscaled": 80.61580662818471, "test_loss_bbox_unscaled": 0.2220337728785861, "test_loss_bbox_0_unscaled": 0.41045688007287917, "test_loss_bbox_1_unscaled": 0.3538018821910688, "test_loss_bbox_2_unscaled": 0.28700053245778295, "test_loss_bbox_3_unscaled": 0.26223795865751376, "test_loss_bbox_4_unscaled": 0.23663100913451734, "test_loss_ce_unscaled": 1.370138221865247, "test_loss_ce_0_unscaled": 1.4795395280145536, "test_loss_ce_1_unscaled": 1.463806616272896, "test_loss_ce_2_unscaled": 1.4175632497307602, "test_loss_ce_3_unscaled": 1.3968758446395777, "test_loss_ce_4_unscaled": 1.383345760737255, "test_loss_giou_unscaled": 0.7866638697636356, "test_loss_giou_0_unscaled": 1.1066848164910723, "test_loss_giou_1_unscaled": 0.9927518037474079, "test_loss_giou_2_unscaled": 0.9150672205694163, "test_loss_giou_3_unscaled": 0.8769618766323016, "test_loss_giou_4_unscaled": 0.8350264885622984, "test_coco_eval_bbox": [0.0025538420077072395, 0.00785953672669776, 0.0012764198464959857, 0.002263049889529184, 0.0017684669320112308, 0.003754754519605244, 0.01362671087598188, 0.03070460682888716, 0.05339734524863692, 0.0036621445231624665, 0.028275972607074262, 0.09866316678023505], "n_parameters": 41302368

Mine:

{"train_lr": 4.999999999999505e-05, "train_class_error": 86.52962853383647, "train_loss": 24.831565185072133, "train_loss_ce": 1.487930963236535, "train_loss_bbox": 1.106589217289985, "train_loss_giou": 1.5006296673657968, "train_loss_ce_0": 1.5683650821134938, "train_loss_bbox_0": 1.1501446843832621, "train_loss_giou_0": 1.5276848722439502, "train_loss_ce_1": 1.5325886286711992, "train_loss_bbox_1": 1.123001427258597, "train_loss_giou_1": 1.5115575443380058, "train_loss_ce_2": 1.5121202014369017, "train_loss_bbox_2": 1.1111633970119037, "train_loss_giou_2": 1.5037757965492, "train_loss_ce_3": 1.50199118992909, "train_loss_bbox_3": 1.102850424924895, "train_loss_giou_3": 1.4977243475104491, "train_loss_ce_4": 1.493773689155527, "train_loss_bbox_4": 1.1020243691680478, "train_loss_giou_4": 1.49764966567223, "train_loss_ce_unscaled": 1.487930963236535, "train_class_error_unscaled": 86.52962853383647, "train_loss_bbox_unscaled": 0.22131784346797476, "train_loss_giou_unscaled": 0.7503148336828984, "train_cardinality_error_unscaled": 8.113332769699019, "train_loss_ce_0_unscaled": 1.5683650821134938, "train_loss_bbox_0_unscaled": 0.23002893683180278, "train_loss_giou_0_unscaled": 0.7638424361219751, "train_cardinality_error_0_unscaled": 7.884004058167061, "train_loss_ce_1_unscaled": 1.5325886286711992, "train_loss_bbox_1_unscaled": 0.22460028544133848, "train_loss_giou_1_unscaled": 0.7557787721690029, "train_cardinality_error_1_unscaled": 7.846381467703754, "train_loss_ce_2_unscaled": 1.5121202014369017, "train_loss_bbox_2_unscaled": 0.22223267934946825, "train_loss_giou_2_unscaled": 0.7518878982746, "train_cardinality_error_2_unscaled": 7.901234359147785, "train_loss_ce_3_unscaled": 1.50199118992909, "train_loss_bbox_3_unscaled": 0.2205700850200524, "train_loss_giou_3_unscaled": 0.7488621737552246, "train_cardinality_error_3_unscaled": 7.98922894825837, "train_loss_ce_4_unscaled": 1.493773689155527, "train_loss_bbox_4_unscaled": 0.22040487382161605, "train_loss_giou_4_unscaled": 0.748824832836115, "train_cardinality_error_4_unscaled": 8.010060872505917, "test_class_error": 80.43325092163086, "test_loss": 29.091288772583006, "test_loss_ce": 1.3773058178901671, "test_loss_bbox": 1.1983217752456665, "test_loss_giou": 1.5670134636878967, "test_loss_ce_0": 1.4929402511596679, "test_loss_bbox_0": 2.168620691108704, "test_loss_giou_0": 2.27720348072052, "test_loss_ce_1": 1.4675289775848388, "test_loss_bbox_1": 1.8921377227783203, "test_loss_giou_1": 2.0321483806610106, "test_loss_ce_2": 1.44651027469635, "test_loss_bbox_2": 1.5869037508010864, "test_loss_giou_2": 1.8327613271713257, "test_loss_ce_3": 1.4104847149848938, "test_loss_bbox_3": 1.3860033449172973, "test_loss_giou_3": 1.7168726323127748, "test_loss_ce_4": 1.389806844997406, "test_loss_bbox_4": 1.2449273197174073, "test_loss_giou_4": 1.603797945213318, "test_loss_ce_unscaled": 1.3773058178901671, "test_class_error_unscaled": 80.43325092163086, "test_loss_bbox_unscaled": 0.23966435492038726, "test_loss_giou_unscaled": 0.7835067318439484, "test_cardinality_error_unscaled": 13.2414, "test_loss_ce_0_unscaled": 1.4929402511596679, "test_loss_bbox_0_unscaled": 0.43372413773536683, "test_loss_giou_0_unscaled": 1.13860174036026, "test_cardinality_error_0_unscaled": 17.636, "test_loss_ce_1_unscaled": 1.4675289775848388, "test_loss_bbox_1_unscaled": 0.37842754497528075, "test_loss_giou_1_unscaled": 1.0160741903305053, "test_cardinality_error_1_unscaled": 19.011, "test_loss_ce_2_unscaled": 1.44651027469635, "test_loss_bbox_2_unscaled": 0.31738075041770936, "test_loss_giou_2_unscaled": 0.9163806635856628, "test_cardinality_error_2_unscaled": 18.7734, "test_loss_ce_3_unscaled": 1.4104847149848938, "test_loss_bbox_3_unscaled": 0.2772006685256958, "test_loss_giou_3_unscaled": 0.8584363161563874, "test_cardinality_error_3_unscaled": 15.0426, "test_loss_ce_4_unscaled": 1.389806844997406, "test_loss_bbox_4_unscaled": 0.24898546411991118, "test_loss_giou_4_unscaled": 0.801898972606659, "test_cardinality_error_4_unscaled": 13.2232, "test_coco_eval_bbox": [0.0021265858757609974, 0.0065877339439397616, 0.000909544949817166, 0.0019531160362775328, 0.002315354314435091, 0.00309375358162458, 0.01123688032113149, 0.026146422736634624, 0.04583708711623451, 0.0036212598786164564, 0.02612322054570953, 0.09013151771112456], "epoch": 0, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 76.09085374896011, "train_loss": 20.667357730833228, "train_loss_ce": 1.1923682319420514, "train_loss_bbox": 0.8397289703252713, "train_loss_giou": 1.313471015196295, "train_loss_ce_0": 1.3113960428257265, "train_loss_bbox_0": 0.9643607099333606, "train_loss_giou_0": 1.4141348524717692, "train_loss_ce_1": 1.2519283091574454, "train_loss_bbox_1": 0.8973104701640439, "train_loss_giou_1": 1.3610730239697555, "train_loss_ce_2": 1.2240295706143602, "train_loss_bbox_2": 0.8591127406010807, "train_loss_giou_2": 1.3291484317507016, "train_loss_ce_3": 1.2088633825680595, "train_loss_bbox_3": 0.8413005754840427, "train_loss_giou_3": 1.314748174927708, "train_loss_ce_4": 1.1985146698937208, "train_loss_bbox_4": 0.8350033468034246, "train_loss_giou_4": 1.3108651984189466, "train_loss_ce_unscaled": 1.1923682319420514, "train_class_error_unscaled": 76.09085374896011, "train_loss_bbox_unscaled": 0.16794579402998086, "train_loss_giou_unscaled": 0.6567355075981475, "train_cardinality_error_unscaled": 9.657380791342577, "train_loss_ce_0_unscaled": 1.3113960428257265, "train_loss_bbox_0_unscaled": 0.19287214206306766, "train_loss_giou_0_unscaled": 0.7070674262358846, "train_cardinality_error_0_unscaled": 8.43508623605005, "train_loss_ce_1_unscaled": 1.2519283091574454, "train_loss_bbox_1_unscaled": 0.17946209403401822, "train_loss_giou_1_unscaled": 0.6805365119848777, "train_cardinality_error_1_unscaled": 8.685238417314846, "train_loss_ce_2_unscaled": 1.2240295706143602, "train_loss_bbox_2_unscaled": 0.17182254807738223, "train_loss_giou_2_unscaled": 0.6645742158753508, "train_cardinality_error_2_unscaled": 9.029852891444031, "train_loss_ce_3_unscaled": 1.2088633825680595, "train_loss_bbox_3_unscaled": 0.1682601150983203, "train_loss_giou_3_unscaled": 0.657374087463854, "train_cardinality_error_3_unscaled": 9.302603990530944, "train_loss_ce_4_unscaled": 1.1985146698937208, "train_loss_bbox_4_unscaled": 0.16700066933921756, "train_loss_giou_4_unscaled": 0.6554325992094733, "train_cardinality_error_4_unscaled": 9.434570510652689, "test_class_error": 67.41067220458984, "test_loss": 19.132641433715822, "test_loss_ce": 1.108450002861023, "test_loss_bbox": 0.7263319275379181, "test_loss_giou": 1.276148030090332, "test_loss_ce_0": 1.2539115529060363, "test_loss_bbox_0": 0.8648859839439392, "test_loss_giou_0": 1.3881386889457703, "test_loss_ce_1": 1.1671034971237182, "test_loss_bbox_1": 0.7593083941459656, "test_loss_giou_1": 1.2976527550697328, "test_loss_ce_2": 1.1346472180366516, "test_loss_bbox_2": 0.7211601636409759, "test_loss_giou_2": 1.2780488300323487, "test_loss_ce_3": 1.1158620573043823, "test_loss_bbox_3": 0.7060411793708802, "test_loss_giou_3": 1.2475539141654968, "test_loss_ce_4": 1.1155061170578002, "test_loss_bbox_4": 0.712302544593811, "test_loss_giou_4": 1.2595886030197143, "test_loss_ce_unscaled": 1.108450002861023, "test_class_error_unscaled": 67.41067220458984, "test_loss_bbox_unscaled": 0.14526638568639755, "test_loss_giou_unscaled": 0.638074015045166, "test_cardinality_error_unscaled": 12.4716, "test_loss_ce_0_unscaled": 1.2539115529060363, "test_loss_bbox_0_unscaled": 0.1729771965265274, "test_loss_giou_0_unscaled": 0.6940693444728852, "test_cardinality_error_0_unscaled": 8.9194, "test_loss_ce_1_unscaled": 1.1671034971237182, "test_loss_bbox_1_unscaled": 0.15186167882680893, "test_loss_giou_1_unscaled": 0.6488263775348664, "test_cardinality_error_1_unscaled": 9.7718, "test_loss_ce_2_unscaled": 1.1346472180366516, "test_loss_bbox_2_unscaled": 0.14423203241825103, "test_loss_giou_2_unscaled": 0.6390244150161744, "test_cardinality_error_2_unscaled": 10.1264, "test_loss_ce_3_unscaled": 1.1158620573043823, "test_loss_bbox_3_unscaled": 0.1412082357764244, "test_loss_giou_3_unscaled": 0.6237769570827484, "test_cardinality_error_3_unscaled": 10.8534, "test_loss_ce_4_unscaled": 1.1155061170578002, "test_loss_bbox_4_unscaled": 0.14246050933599472, "test_loss_giou_4_unscaled": 0.6297943015098572, "test_cardinality_error_4_unscaled": 11.4292, "test_coco_eval_bbox": [0.010753811026827678, 0.03152517963448983, 0.005490511804918142, 0.0032842124195707847, 0.008969594438516526, 0.01885071378580583, 0.038514376727083396, 0.09128783334186322, 0.13004947207333156, 0.009544281042833334, 0.08365698462368425, 0.25694375672558045], "epoch": 1, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 65.44690313793978, "train_loss": 17.539118461815296, "train_loss_ce": 1.0081125720675266, "train_loss_bbox": 0.6678093300746186, "train_loss_giou": 1.1595920812148357, "train_loss_ce_0": 1.1331905804073081, "train_loss_bbox_0": 0.7810623647233784, "train_loss_giou_0": 1.2641290029501406, "train_loss_ce_1": 1.0522435841001607, "train_loss_bbox_1": 0.7041109337248752, "train_loss_giou_1": 1.1939036907418419, "train_loss_ce_2": 1.0306178582553167, "train_loss_bbox_2": 0.6839830565581582, "train_loss_giou_2": 1.175401590803325, "train_loss_ce_3": 1.0186759350910193, "train_loss_bbox_3": 0.6698409747968544, "train_loss_giou_3": 1.1612845506827736, "train_loss_ce_4": 1.0115652649536462, "train_loss_bbox_4": 0.6659862823368611, "train_loss_giou_4": 1.1576087987620483, "train_loss_ce_unscaled": 1.0081125720675266, "train_class_error_unscaled": 65.44690313793978, "train_loss_bbox_unscaled": 0.1335618659672521, "train_loss_giou_unscaled": 0.5797960406074179, "train_cardinality_error_unscaled": 11.193058843422387, "train_loss_ce_0_unscaled": 1.1331905804073081, "train_loss_bbox_0_unscaled": 0.15621247298367974, "train_loss_giou_0_unscaled": 0.6320645014750703, "train_cardinality_error_0_unscaled": 9.365894487656409, "train_loss_ce_1_unscaled": 1.0522435841001607, "train_loss_bbox_1_unscaled": 0.14082218675263475, "train_loss_giou_1_unscaled": 0.5969518453709209, "train_cardinality_error_1_unscaled": 10.266849847818735, "train_loss_ce_2_unscaled": 1.0306178582553167, "train_loss_bbox_2_unscaled": 0.1367966113378359, "train_loss_giou_2_unscaled": 0.5877007954016625, "train_cardinality_error_2_unscaled": 10.676369631383158, "train_loss_ce_3_unscaled": 1.0186759350910193, "train_loss_bbox_3_unscaled": 0.13396819496239445, "train_loss_giou_3_unscaled": 0.5806422753413868, "train_cardinality_error_3_unscaled": 10.789592492390936, "train_loss_ce_4_unscaled": 1.0115652649536462, "train_loss_bbox_4_unscaled": 0.13319725645709207, "train_loss_giou_4_unscaled": 0.5788043993810241, "train_cardinality_error_4_unscaled": 10.969944200202908, "test_class_error": 57.09059805908203, "test_loss": 16.124311026000978, "test_loss_ce": 0.9600695120811462, "test_loss_bbox": 0.5623337291240692, "test_loss_giou": 1.1022248458862305, "test_loss_ce_0": 1.0484189204216003, "test_loss_bbox_0": 0.6295936774253845, "test_loss_giou_0": 1.1844789880752564, "test_loss_ce_1": 0.9877917276382446, "test_loss_bbox_1": 0.5872869284629821, "test_loss_giou_1": 1.1404185472488404, "test_loss_ce_2": 0.9741755627632142, "test_loss_bbox_2": 0.5724226105213165, "test_loss_giou_2": 1.118540744972229, "test_loss_ce_3": 0.9643696274757385, "test_loss_bbox_3": 0.5611338304042817, "test_loss_giou_3": 1.1053467128753662, "test_loss_ce_4": 0.9597394149303436, "test_loss_bbox_4": 0.559213963508606, "test_loss_giou_4": 1.1067516328811646, "test_loss_ce_unscaled": 0.9600695120811462, "test_class_error_unscaled": 57.09059805908203, "test_loss_bbox_unscaled": 0.11246674568653106, "test_loss_giou_unscaled": 0.5511124229431152, "test_cardinality_error_unscaled": 14.078, "test_loss_ce_0_unscaled": 1.0484189204216003, "test_loss_bbox_0_unscaled": 0.12591873524188996, "test_loss_giou_0_unscaled": 0.5922394940376282, "test_cardinality_error_0_unscaled": 12.634, "test_loss_ce_1_unscaled": 0.9877917276382446, "test_loss_bbox_1_unscaled": 0.11745738576650619, "test_loss_giou_1_unscaled": 0.5702092736244202, "test_cardinality_error_1_unscaled": 13.031, "test_loss_ce_2_unscaled": 0.9741755627632142, "test_loss_bbox_2_unscaled": 0.11448452210426331, "test_loss_giou_2_unscaled": 0.5592703724861146, "test_cardinality_error_2_unscaled": 13.5576, "test_loss_ce_3_unscaled": 0.9643696274757385, "test_loss_bbox_3_unscaled": 0.11222676604986191, "test_loss_giou_3_unscaled": 0.5526733564376831, "test_cardinality_error_3_unscaled": 13.4306, "test_loss_ce_4_unscaled": 0.9597394149303436, "test_loss_bbox_4_unscaled": 0.11184279274940491, "test_loss_giou_4_unscaled": 0.5533758164405823, "test_cardinality_error_4_unscaled": 14.0204, "test_coco_eval_bbox": [0.023065761904305454, 0.0642997525084297, 0.012688547615906043, 0.009530793994041994, 0.022989181977061512, 0.03953573825789254, 0.05937750357043031, 0.14538116446182525, 0.19895908903797746, 0.026496916694804817, 0.17003034290587363, 0.3775779931121663], "epoch": 2, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 58.123145140414714, "train_loss": 15.634823303493569, "train_loss_ce": 0.9068054199158279, "train_loss_bbox": 0.5721039568224912, "train_loss_giou": 1.0607737171053282, "train_loss_ce_0": 0.9805686120431408, "train_loss_bbox_0": 0.6522726859742417, "train_loss_giou_0": 1.141636572623519, "train_loss_ce_1": 0.9322088563043119, "train_loss_bbox_1": 0.6055919122083147, "train_loss_giou_1": 1.094846903205442, "train_loss_ce_2": 0.920313758401803, "train_loss_bbox_2": 0.5883373138305501, "train_loss_giou_2": 1.0791223229167024, "train_loss_ce_3": 0.9131880141913105, "train_loss_bbox_3": 0.5769328866974098, "train_loss_giou_3": 1.0678299716005142, "train_loss_ce_4": 0.9081369045762787, "train_loss_bbox_4": 0.5725347533131678, "train_loss_giou_4": 1.0616187397172654, "train_loss_ce_unscaled": 0.9068054199158279, "train_class_error_unscaled": 58.123145140414714, "train_loss_bbox_unscaled": 0.11442079136439744, "train_loss_giou_unscaled": 0.5303868585526641, "train_cardinality_error_unscaled": 12.113112952316538, "train_loss_ce_0_unscaled": 0.9805686120431408, "train_loss_bbox_0_unscaled": 0.130454537190313, "train_loss_giou_0_unscaled": 0.5708182863117595, "train_cardinality_error_0_unscaled": 10.695645924923909, "train_loss_ce_1_unscaled": 0.9322088563043119, "train_loss_bbox_1_unscaled": 0.12111838242624272, "train_loss_giou_1_unscaled": 0.547423451602721, "train_cardinality_error_1_unscaled": 11.35789651673994, "train_loss_ce_2_unscaled": 0.920313758401803, "train_loss_bbox_2_unscaled": 0.11766746276873045, "train_loss_giou_2_unscaled": 0.5395611614583512, "train_cardinality_error_2_unscaled": 11.717729117348664, "train_loss_ce_3_unscaled": 0.9131880141913105, "train_loss_bbox_3_unscaled": 0.11538657734865347, "train_loss_giou_3_unscaled": 0.5339149858002571, "train_cardinality_error_3_unscaled": 11.80929151166723, "train_loss_ce_4_unscaled": 0.9081369045762787, "train_loss_bbox_4_unscaled": 0.1145069506489267, "train_loss_giou_4_unscaled": 0.5308093698586327, "train_cardinality_error_4_unscaled": 11.949061548867094, "test_class_error": 49.551349798583985, "test_loss": 15.061002113342285, "test_loss_ce": 0.8770741714000702, "test_loss_bbox": 0.5183729804515839, "test_loss_giou": 1.0674869118213655, "test_loss_ce_0": 0.9338070053577423, "test_loss_bbox_0": 0.5919236281871796, "test_loss_giou_0": 1.138515215587616, "test_loss_ce_1": 0.8907434218883514, "test_loss_bbox_1": 0.548049247932434, "test_loss_giou_1": 1.0852307609558105, "test_loss_ce_2": 0.8890087683200836, "test_loss_bbox_2": 0.5357075645446777, "test_loss_giou_2": 1.0730161080360412, "test_loss_ce_3": 0.8833201575756073, "test_loss_bbox_3": 0.5236723579883575, "test_loss_giou_3": 1.0658272340297699, "test_loss_ce_4": 0.8753786478996277, "test_loss_bbox_4": 0.5163941194534302, "test_loss_giou_4": 1.0474738049507142, "test_loss_ce_unscaled": 0.8770741714000702, "test_class_error_unscaled": 49.551349798583985, "test_loss_bbox_unscaled": 0.10367459589242935, "test_loss_giou_unscaled": 0.5337434559106827, "test_cardinality_error_unscaled": 14.9716, "test_loss_ce_0_unscaled": 0.9338070053577423, "test_loss_bbox_0_unscaled": 0.11838472580909729, "test_loss_giou_0_unscaled": 0.569257607793808, "test_cardinality_error_0_unscaled": 14.8932, "test_loss_ce_1_unscaled": 0.8907434218883514, "test_loss_bbox_1_unscaled": 0.109609849691391, "test_loss_giou_1_unscaled": 0.5426153804779053, "test_cardinality_error_1_unscaled": 14.81, "test_loss_ce_2_unscaled": 0.8890087683200836, "test_loss_bbox_2_unscaled": 0.10714151285290718, "test_loss_giou_2_unscaled": 0.5365080540180206, "test_cardinality_error_2_unscaled": 14.8956, "test_loss_ce_3_unscaled": 0.8833201575756073, "test_loss_bbox_3_unscaled": 0.10473447157740592, "test_loss_giou_3_unscaled": 0.5329136170148849, "test_cardinality_error_3_unscaled": 15.7516, "test_loss_ce_4_unscaled": 0.8753786478996277, "test_loss_bbox_4_unscaled": 0.10327882392406464, "test_loss_giou_4_unscaled": 0.5237369024753571, "test_cardinality_error_4_unscaled": 14.9662, "test_coco_eval_bbox": [0.038157756828519844, 0.09977916387371052, 0.022809613712737264, 0.012056279862400114, 0.03580250502616357, 0.06717666689853588, 0.08764914528964286, 0.1816402721009194, 0.22310999442541735, 0.03666911777952882, 0.19940256157259603, 0.4166815069349573], "epoch": 3, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 52.910601250884255, "train_loss": 14.567965375179773, "train_loss_ce": 0.8454773213660189, "train_loss_bbox": 0.5206638104888608, "train_loss_giou": 1.0004974102869122, "train_loss_ce_0": 0.9012234728663686, "train_loss_bbox_0": 0.5978291686096424, "train_loss_giou_0": 1.0825191715157108, "train_loss_ce_1": 0.8650968681891141, "train_loss_bbox_1": 0.5536538288566685, "train_loss_giou_1": 1.0367729309950078, "train_loss_ce_2": 0.8571913154394513, "train_loss_bbox_2": 0.5357322960336103, "train_loss_giou_2": 1.0176982369461613, "train_loss_ce_3": 0.8507537800414279, "train_loss_bbox_3": 0.5253412322394139, "train_loss_giou_3": 1.0078691358638043, "train_loss_ce_4": 0.8452474541062635, "train_loss_bbox_4": 0.5223584449156177, "train_loss_giou_4": 1.002039504976421, "train_loss_ce_unscaled": 0.8454773213660189, "train_class_error_unscaled": 52.910601250884255, "train_loss_bbox_unscaled": 0.10413276209550448, "train_loss_giou_unscaled": 0.5002487051434561, "train_cardinality_error_unscaled": 12.681273249915455, "train_loss_ce_0_unscaled": 0.9012234728663686, "train_loss_bbox_0_unscaled": 0.11956583369683284, "train_loss_giou_0_unscaled": 0.5412595857578554, "train_cardinality_error_0_unscaled": 11.394538383496787, "train_loss_ce_1_unscaled": 0.8650968681891141, "train_loss_bbox_1_unscaled": 0.11073076575112617, "train_loss_giou_1_unscaled": 0.5183864654975039, "train_cardinality_error_1_unscaled": 11.891469394656747, "train_loss_ce_2_unscaled": 0.8571913154394513, "train_loss_bbox_2_unscaled": 0.10714645917814931, "train_loss_giou_2_unscaled": 0.5088491184730807, "train_cardinality_error_2_unscaled": 12.255047345282382, "train_loss_ce_3_unscaled": 0.8507537800414279, "train_loss_bbox_3_unscaled": 0.10506824642611308, "train_loss_giou_3_unscaled": 0.5039345679319022, "train_cardinality_error_3_unscaled": 12.368050388907676, "train_loss_ce_4_unscaled": 0.8452474541062635, "train_loss_bbox_4_unscaled": 0.10447168895923732, "train_loss_giou_4_unscaled": 0.5010197524882105, "train_cardinality_error_4_unscaled": 12.515886033141697, "test_class_error": 44.53961072998047, "test_loss": 14.175317761230469, "test_loss_ce": 0.8328801611423492, "test_loss_bbox": 0.4746467393398285, "test_loss_giou": 1.0000780092716217, "test_loss_ce_0": 0.891690441083908, "test_loss_bbox_0": 0.542296701002121, "test_loss_giou_0": 1.0839348940849305, "test_loss_ce_1": 0.8520510860919952, "test_loss_bbox_1": 0.5056982625961304, "test_loss_giou_1": 1.044106041765213, "test_loss_ce_2": 0.8414757890224457, "test_loss_bbox_2": 0.4804409171104431, "test_loss_giou_2": 1.0089589943408965, "test_loss_ce_3": 0.8379640578269959, "test_loss_bbox_3": 0.47531861305236817, "test_loss_giou_3": 0.9964562111854554, "test_loss_ce_4": 0.8304318719863891, "test_loss_bbox_4": 0.4747223759174347, "test_loss_giou_4": 1.0021665647029876, "test_loss_ce_unscaled": 0.8328801611423492, "test_class_error_unscaled": 44.53961072998047, "test_loss_bbox_unscaled": 0.09492934783101081, "test_loss_giou_unscaled": 0.5000390046358109, "test_cardinality_error_unscaled": 16.2888, "test_loss_ce_0_unscaled": 0.891690441083908, "test_loss_bbox_0_unscaled": 0.10845934026241302, "test_loss_giou_0_unscaled": 0.5419674470424652, "test_cardinality_error_0_unscaled": 17.2246, "test_loss_ce_1_unscaled": 0.8520510860919952, "test_loss_bbox_1_unscaled": 0.10113965281248093, "test_loss_giou_1_unscaled": 0.5220530208826065, "test_cardinality_error_1_unscaled": 17.4746, "test_loss_ce_2_unscaled": 0.8414757890224457, "test_loss_bbox_2_unscaled": 0.09608818338513374, "test_loss_giou_2_unscaled": 0.5044794971704483, "test_cardinality_error_2_unscaled": 17.1846, "test_loss_ce_3_unscaled": 0.8379640578269959, "test_loss_bbox_3_unscaled": 0.09506372266411782, "test_loss_giou_3_unscaled": 0.4982281055927277, "test_cardinality_error_3_unscaled": 17.0962, "test_loss_ce_4_unscaled": 0.8304318719863891, "test_loss_bbox_4_unscaled": 0.09494447509050369, "test_loss_giou_4_unscaled": 0.5010832823514938, "test_cardinality_error_4_unscaled": 16.1288, "test_coco_eval_bbox": [0.048360795565295676, 0.1216059068472204, 0.030529331131183723, 0.014372942148369428, 0.049950380519485596, 0.07929304153471209, 0.1034364504350481, 0.21445406540026007, 0.25863905037757423, 0.04445839057998536, 0.2443942274126949, 0.47265187023944394], "epoch": 4, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 49.09402930447085, "train_loss": 13.88931438060963, "train_loss_ce": 0.8051403547687872, "train_loss_bbox": 0.4880853011211431, "train_loss_giou": 0.9639010042062998, "train_loss_ce_0": 0.8562600254508583, "train_loss_bbox_0": 0.5622997942993195, "train_loss_giou_0": 1.045607688114939, "train_loss_ce_1": 0.823583537517547, "train_loss_bbox_1": 0.5176720756088756, "train_loss_giou_1": 0.9986401422123753, "train_loss_ce_2": 0.8171499014565943, "train_loss_bbox_2": 0.5003126291072486, "train_loss_giou_2": 0.9795767501011707, "train_loss_ce_3": 0.8103475715406931, "train_loss_bbox_3": 0.49128819133205753, "train_loss_giou_3": 0.9700130084236611, "train_loss_ce_4": 0.8042584525922041, "train_loss_bbox_4": 0.48950320937099756, "train_loss_giou_4": 0.9656747411544717, "train_loss_ce_unscaled": 0.8051403547687872, "train_class_error_unscaled": 49.09402930447085, "train_loss_bbox_unscaled": 0.09761706022775613, "train_loss_giou_unscaled": 0.4819505021031499, "train_cardinality_error_unscaled": 12.749053094352384, "train_loss_ce_0_unscaled": 0.8562600254508583, "train_loss_bbox_0_unscaled": 0.11245995885190184, "train_loss_giou_0_unscaled": 0.5228038440574695, "train_cardinality_error_0_unscaled": 11.886447412918498, "train_loss_ce_1_unscaled": 0.823583537517547, "train_loss_bbox_1_unscaled": 0.10353441515664696, "train_loss_giou_1_unscaled": 0.49932007110618765, "train_cardinality_error_1_unscaled": 12.172573554277985, "train_loss_ce_2_unscaled": 0.8171499014565943, "train_loss_bbox_2_unscaled": 0.1000625258201395, "train_loss_giou_2_unscaled": 0.48978837505058537, "train_cardinality_error_2_unscaled": 12.499560365235036, "train_loss_ce_3_unscaled": 0.8103475715406931, "train_loss_bbox_3_unscaled": 0.0982576382855104, "train_loss_giou_3_unscaled": 0.48500650421183056, "train_cardinality_error_3_unscaled": 12.511768684477511, "train_loss_ce_4_unscaled": 0.8042584525922041, "train_loss_bbox_4_unscaled": 0.09790064185545337, "train_loss_giou_4_unscaled": 0.48283737057723586, "train_cardinality_error_4_unscaled": 12.543760568143389, "test_class_error": 41.437824468994144, "test_loss": 13.427777368164062, "test_loss_ce": 0.787802452135086, "test_loss_bbox": 0.43913414697647096, "test_loss_giou": 0.9550578608989716, "test_loss_ce_0": 0.8472408934593201, "test_loss_bbox_0": 0.517391251039505, "test_loss_giou_0": 1.0377634164333343, "test_loss_ce_1": 0.8097211413860321, "test_loss_bbox_1": 0.4700230944156647, "test_loss_giou_1": 0.9887780944824218, "test_loss_ce_2": 0.7975951600551605, "test_loss_bbox_2": 0.45308130438327787, "test_loss_giou_2": 0.9668065618991852, "test_loss_ce_3": 0.7904535554409027, "test_loss_bbox_3": 0.44117223880290984, "test_loss_giou_3": 0.9489892199039459, "test_loss_ce_4": 0.7836217448234558, "test_loss_bbox_4": 0.44164337589740754, "test_loss_giou_4": 0.9515018527030945, "test_loss_ce_unscaled": 0.787802452135086, "test_class_error_unscaled": 41.437824468994144, "test_loss_bbox_unscaled": 0.08782682939767837, "test_loss_giou_unscaled": 0.4775289304494858, "test_cardinality_error_unscaled": 15.763, "test_loss_ce_0_unscaled": 0.8472408934593201, "test_loss_bbox_0_unscaled": 0.10347825030088424, "test_loss_giou_0_unscaled": 0.5188817082166671, "test_cardinality_error_0_unscaled": 16.6142, "test_loss_ce_1_unscaled": 0.8097211413860321, "test_loss_bbox_1_unscaled": 0.09400461881160736, "test_loss_giou_1_unscaled": 0.4943890472412109, "test_cardinality_error_1_unscaled": 16.4656, "test_loss_ce_2_unscaled": 0.7975951600551605, "test_loss_bbox_2_unscaled": 0.09061626084446907, "test_loss_giou_2_unscaled": 0.4834032809495926, "test_cardinality_error_2_unscaled": 15.897, "test_loss_ce_3_unscaled": 0.7904535554409027, "test_loss_bbox_3_unscaled": 0.08823444778323174, "test_loss_giou_3_unscaled": 0.47449460995197296, "test_cardinality_error_3_unscaled": 16.2582, "test_loss_ce_4_unscaled": 0.7836217448234558, "test_loss_bbox_4_unscaled": 0.08832867520451546, "test_loss_giou_4_unscaled": 0.47575092635154725, "test_cardinality_error_4_unscaled": 15.7084, "test_coco_eval_bbox": [0.0753621639169211, 0.17133279114356648, 0.0571039338195079, 0.021259452077924557, 0.07156104731347739, 0.12960728382068756, 0.12969942787882616, 0.24603205742483097, 0.28863014734599535, 0.0626925973739434, 0.28485516772146946, 0.5127380266300929], "epoch": 5, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 46.15468981952171, "train_loss": 13.356757492449866, "train_loss_ce": 0.7696863772147888, "train_loss_bbox": 0.4669100113785021, "train_loss_giou": 0.9329292574100572, "train_loss_ce_0": 0.8226484856887326, "train_loss_bbox_0": 0.537852906527695, "train_loss_giou_0": 1.0154834073199426, "train_loss_ce_1": 0.7916540872075084, "train_loss_bbox_1": 0.49337688092750837, "train_loss_giou_1": 0.966573053830211, "train_loss_ce_2": 0.7828350444974067, "train_loss_bbox_2": 0.4769112671322624, "train_loss_giou_2": 0.9473614184718137, "train_loss_ce_3": 0.7755656775264753, "train_loss_bbox_3": 0.4683837730496729, "train_loss_giou_3": 0.9382449819665121, "train_loss_ce_4": 0.768146341745822, "train_loss_bbox_4": 0.46779664643700963, "train_loss_giou_4": 0.934397875178211, "train_loss_ce_unscaled": 0.7696863772147888, "train_class_error_unscaled": 46.15468981952171, "train_loss_bbox_unscaled": 0.09338200229736934, "train_loss_giou_unscaled": 0.4664646287050286, "train_cardinality_error_unscaled": 12.55789651673994, "train_loss_ce_0_unscaled": 0.8226484856887326, "train_loss_bbox_0_unscaled": 0.10757058127873001, "train_loss_giou_0_unscaled": 0.5077417036599713, "train_cardinality_error_0_unscaled": 12.110999323638824, "train_loss_ce_1_unscaled": 0.7916540872075084, "train_loss_bbox_1_unscaled": 0.09867537617884982, "train_loss_giou_1_unscaled": 0.4832865269151055, "train_cardinality_error_1_unscaled": 12.295662833953331, "train_loss_ce_2_unscaled": 0.7828350444974067, "train_loss_bbox_2_unscaled": 0.09538225343512005, "train_loss_giou_2_unscaled": 0.4736807092359068, "train_cardinality_error_2_unscaled": 12.43873858640514, "train_loss_ce_3_unscaled": 0.7755656775264753, "train_loss_bbox_3_unscaled": 0.09367675461683839, "train_loss_giou_3_unscaled": 0.46912249098325604, "train_cardinality_error_3_unscaled": 12.413645586743321, "train_loss_ce_4_unscaled": 0.768146341745822, "train_loss_bbox_4_unscaled": 0.09355932927571078, "train_loss_giou_4_unscaled": 0.4671989375891055, "train_cardinality_error_4_unscaled": 12.37401082177883, "test_class_error": 40.08195360107422, "test_loss": 13.30881737060547, "test_loss_ce": 0.7774070368289947, "test_loss_bbox": 0.42339387180805205, "test_loss_giou": 0.9598953552722931, "test_loss_ce_0": 0.8389887240409851, "test_loss_bbox_0": 0.4930052506446838, "test_loss_giou_0": 1.028972688627243, "test_loss_ce_1": 0.7995826546669006, "test_loss_bbox_1": 0.4509546326875687, "test_loss_giou_1": 0.9933206167697907, "test_loss_ce_2": 0.7928187554359436, "test_loss_bbox_2": 0.43014699506759646, "test_loss_giou_2": 0.9701415934085846, "test_loss_ce_3": 0.7829234425067901, "test_loss_bbox_3": 0.42475661079883575, "test_loss_giou_3": 0.9683983160972596, "test_loss_ce_4": 0.7756322005271912, "test_loss_bbox_4": 0.42777857992649077, "test_loss_giou_4": 0.9706999873161316, "test_loss_ce_unscaled": 0.7774070368289947, "test_class_error_unscaled": 40.08195360107422, "test_loss_bbox_unscaled": 0.08467877444028854, "test_loss_giou_unscaled": 0.47994767763614654, "test_cardinality_error_unscaled": 15.6494, "test_loss_ce_0_unscaled": 0.8389887240409851, "test_loss_bbox_0_unscaled": 0.09860105019211769, "test_loss_giou_0_unscaled": 0.5144863443136215, "test_cardinality_error_0_unscaled": 17.606, "test_loss_ce_1_unscaled": 0.7995826546669006, "test_loss_bbox_1_unscaled": 0.09019092654585838, "test_loss_giou_1_unscaled": 0.49666030838489533, "test_cardinality_error_1_unscaled": 16.075, "test_loss_ce_2_unscaled": 0.7928187554359436, "test_loss_bbox_2_unscaled": 0.08602939898967743, "test_loss_giou_2_unscaled": 0.4850707967042923, "test_cardinality_error_2_unscaled": 16.025, "test_loss_ce_3_unscaled": 0.7829234425067901, "test_loss_bbox_3_unscaled": 0.08495132222771645, "test_loss_giou_3_unscaled": 0.4841991580486298, "test_cardinality_error_3_unscaled": 15.501, "test_loss_ce_4_unscaled": 0.7756322005271912, "test_loss_bbox_4_unscaled": 0.08555571602582931, "test_loss_giou_4_unscaled": 0.4853499936580658, "test_cardinality_error_4_unscaled": 15.2294, "test_coco_eval_bbox": [0.08969020871458368, 0.1875552008677939, 0.07673145317888833, 0.021101967744222596, 0.0829416699914306, 0.15803356829969611, 0.14201768394309364, 0.26072781949290713, 0.3062617068649769, 0.06514576780297467, 0.30333920854587837, 0.5582191343853489], "epoch": 6, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 43.18363251619981, "train_loss": 12.928661993721429, "train_loss_ce": 0.7359866039275035, "train_loss_bbox": 0.45057552674452034, "train_loss_giou": 0.9119154474563521, "train_loss_ce_0": 0.7924499040485276, "train_loss_bbox_0": 0.5199660372222079, "train_loss_giou_0": 0.9939120776293686, "train_loss_ce_1": 0.7619385251069254, "train_loss_bbox_1": 0.47404238075108635, "train_loss_giou_1": 0.9427448339525977, "train_loss_ce_2": 0.7508082910994238, "train_loss_bbox_2": 0.4600243795460287, "train_loss_giou_2": 0.9244481410777041, "train_loss_ce_3": 0.742399576215636, "train_loss_bbox_3": 0.4519608535031269, "train_loss_giou_3": 0.9165734429052241, "train_loss_ce_4": 0.7352501261605174, "train_loss_bbox_4": 0.45096602341311987, "train_loss_giou_4": 0.9126998181959081, "train_loss_ce_unscaled": 0.7359866039275035, "train_class_error_unscaled": 43.18363251619981, "train_loss_bbox_unscaled": 0.0901151053310146, "train_loss_giou_unscaled": 0.45595772372817606, "train_cardinality_error_unscaled": 12.287521136286777, "train_loss_ce_0_unscaled": 0.7924499040485276, "train_loss_bbox_0_unscaled": 0.10399320746016413, "train_loss_giou_0_unscaled": 0.4969560388146843, "train_cardinality_error_0_unscaled": 12.17845789651674, "train_loss_ce_1_unscaled": 0.7619385251069254, "train_loss_bbox_1_unscaled": 0.09480847612950581, "train_loss_giou_1_unscaled": 0.47137241697629884, "train_cardinality_error_1_unscaled": 12.216342576936084, "train_loss_ce_2_unscaled": 0.7508082910994238, "train_loss_bbox_2_unscaled": 0.09200487589696028, "train_loss_giou_2_unscaled": 0.46222407053885206, "train_cardinality_error_2_unscaled": 12.250929996618193, "train_loss_ce_3_unscaled": 0.742399576215636, "train_loss_bbox_3_unscaled": 0.09039217069830732, "train_loss_giou_3_unscaled": 0.45828672145261207, "train_cardinality_error_3_unscaled": 12.14217957389246, "train_loss_ce_4_unscaled": 0.7352501261605174, "train_loss_bbox_4_unscaled": 0.09019320468075943, "train_loss_giou_4_unscaled": 0.45634990909795403, "train_cardinality_error_4_unscaled": 12.103990530943523, "test_class_error": 32.79884150390625, "test_loss": 12.647502999114991, "test_loss_ce": 0.7411235553264618, "test_loss_bbox": 0.3979902262687683, "test_loss_giou": 0.909049413728714, "test_loss_ce_0": 0.7953892179012299, "test_loss_bbox_0": 0.463200950050354, "test_loss_giou_0": 1.0005519790649413, "test_loss_ce_1": 0.7658045515060424, "test_loss_bbox_1": 0.421468211889267, "test_loss_giou_1": 0.9410289190292358, "test_loss_ce_2": 0.7539532586097717, "test_loss_bbox_2": 0.40858276319503783, "test_loss_giou_2": 0.9270620748519898, "test_loss_ce_3": 0.7490422872543335, "test_loss_bbox_3": 0.40172316007614134, "test_loss_giou_3": 0.920305546951294, "test_loss_ce_4": 0.7390880799770355, "test_loss_bbox_4": 0.39850156466960907, "test_loss_giou_4": 0.913637275648117, "test_loss_ce_unscaled": 0.7411235553264618, "test_class_error_unscaled": 32.79884150390625, "test_loss_bbox_unscaled": 0.07959804519414902, "test_loss_giou_unscaled": 0.454524706864357, "test_cardinality_error_unscaled": 19.4748, "test_loss_ce_0_unscaled": 0.7953892179012299, "test_loss_bbox_0_unscaled": 0.09264018992185592, "test_loss_giou_0_unscaled": 0.5002759895324707, "test_cardinality_error_0_unscaled": 21.3014, "test_loss_ce_1_unscaled": 0.7658045515060424, "test_loss_bbox_1_unscaled": 0.08429364239573478, "test_loss_giou_1_unscaled": 0.4705144595146179, "test_cardinality_error_1_unscaled": 20.6814, "test_loss_ce_2_unscaled": 0.7539532586097717, "test_loss_bbox_2_unscaled": 0.0817165526330471, "test_loss_giou_2_unscaled": 0.4635310374259949, "test_cardinality_error_2_unscaled": 20.2068, "test_loss_ce_3_unscaled": 0.7490422872543335, "test_loss_bbox_3_unscaled": 0.08034463208317756, "test_loss_giou_3_unscaled": 0.460152773475647, "test_cardinality_error_3_unscaled": 20.0814, "test_loss_ce_4_unscaled": 0.7390880799770355, "test_loss_bbox_4_unscaled": 0.07970031296014786, "test_loss_giou_4_unscaled": 0.4568186378240585, "test_cardinality_error_4_unscaled": 19.6282, "test_coco_eval_bbox": [0.10971163931906756, 0.22108750211829867, 0.09862328230498589, 0.026747230561402442, 0.1029562715282932, 0.1874175043967952, 0.16022707878947312, 0.28284176833998026, 0.32719490771193377, 0.08670647318209522, 0.3280892514245053, 0.5596389234852788], "epoch": 7, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 41.32876692750303, "train_loss": 12.565088790245946, "train_loss_ce": 0.7102701012038846, "train_loss_bbox": 0.43545943105648127, "train_loss_giou": 0.8922024872160297, "train_loss_ce_0": 0.7688998975199867, "train_loss_bbox_0": 0.5020540769635563, "train_loss_giou_0": 0.9729264145652144, "train_loss_ce_1": 0.7408348711673013, "train_loss_bbox_1": 0.45726353058570696, "train_loss_giou_1": 0.9216086005696905, "train_loss_ce_2": 0.7271914865858135, "train_loss_bbox_2": 0.4434237020167701, "train_loss_giou_2": 0.9040516076295168, "train_loss_ce_3": 0.7180560276189445, "train_loss_bbox_3": 0.4366556403380534, "train_loss_giou_3": 0.8959761093486834, "train_loss_ce_4": 0.7094954959869304, "train_loss_bbox_4": 0.43606515637535, "train_loss_giou_4": 0.8926541633790597, "train_loss_ce_unscaled": 0.7102701012038846, "train_class_error_unscaled": 41.32876692750303, "train_loss_bbox_unscaled": 0.08709188620655932, "train_loss_giou_unscaled": 0.44610124360801484, "train_cardinality_error_unscaled": 11.9231315522489, "train_loss_ce_0_unscaled": 0.7688998975199867, "train_loss_bbox_0_unscaled": 0.10041081538832708, "train_loss_giou_0_unscaled": 0.4864632072826072, "train_cardinality_error_0_unscaled": 12.33487487318228, "train_loss_ce_1_unscaled": 0.7408348711673013, "train_loss_bbox_1_unscaled": 0.09145270608186641, "train_loss_giou_1_unscaled": 0.46080430028484526, "train_cardinality_error_1_unscaled": 12.211219141021305, "train_loss_ce_2_unscaled": 0.7271914865858135, "train_loss_bbox_2_unscaled": 0.08868474039750845, "train_loss_giou_2_unscaled": 0.4520258038147584, "train_cardinality_error_2_unscaled": 12.060204599256002, "train_loss_ce_3_unscaled": 0.7180560276189445, "train_loss_bbox_3_unscaled": 0.08733112807481684, "train_loss_giou_3_unscaled": 0.4479880546743417, "train_cardinality_error_3_unscaled": 11.86512512681772, "train_loss_ce_4_unscaled": 0.7094954959869304, "train_loss_bbox_4_unscaled": 0.08721303125546719, "train_loss_giou_4_unscaled": 0.44632708168952984, "train_cardinality_error_4_unscaled": 11.743709841055123, "test_class_error": 35.01635078735352, "test_loss": 12.438361701965333, "test_loss_ce": 0.704987281703949, "test_loss_bbox": 0.41004144899845124, "test_loss_giou": 0.8940009286880494, "test_loss_ce_0": 0.7695276757717132, "test_loss_bbox_0": 0.47129037928581236, "test_loss_giou_0": 0.9824907831192017, "test_loss_ce_1": 0.7344417370319366, "test_loss_bbox_1": 0.42839712178707123, "test_loss_giou_1": 0.9332185081005097, "test_loss_ce_2": 0.7212486369609833, "test_loss_bbox_2": 0.4198228838443756, "test_loss_giou_2": 0.9134346384525299, "test_loss_ce_3": 0.7114209938526154, "test_loss_bbox_3": 0.4146132714509964, "test_loss_giou_3": 0.9188873419761657, "test_loss_ce_4": 0.7008796391010285, "test_loss_bbox_4": 0.40939249355793, "test_loss_giou_4": 0.9002659332275391, "test_loss_ce_unscaled": 0.704987281703949, "test_class_error_unscaled": 35.01635078735352, "test_loss_bbox_unscaled": 0.08200828979611396, "test_loss_giou_unscaled": 0.4470004643440247, "test_cardinality_error_unscaled": 14.4724, "test_loss_ce_0_unscaled": 0.7695276757717132, "test_loss_bbox_0_unscaled": 0.09425807585716248, "test_loss_giou_0_unscaled": 0.49124539155960084, "test_cardinality_error_0_unscaled": 18.372, "test_loss_ce_1_unscaled": 0.7344417370319366, "test_loss_bbox_1_unscaled": 0.08567942419052124, "test_loss_giou_1_unscaled": 0.46660925405025483, "test_cardinality_error_1_unscaled": 17.0772, "test_loss_ce_2_unscaled": 0.7212486369609833, "test_loss_bbox_2_unscaled": 0.08396457683444024, "test_loss_giou_2_unscaled": 0.45671731922626496, "test_cardinality_error_2_unscaled": 16.541, "test_loss_ce_3_unscaled": 0.7114209938526154, "test_loss_bbox_3_unscaled": 0.0829226543188095, "test_loss_giou_3_unscaled": 0.45944367098808286, "test_cardinality_error_3_unscaled": 15.5106, "test_loss_ce_4_unscaled": 0.7008796391010285, "test_loss_bbox_4_unscaled": 0.08187849867939949, "test_loss_giou_4_unscaled": 0.45013296661376956, "test_cardinality_error_4_unscaled": 14.9596, "test_coco_eval_bbox": [0.12966267325779635, 0.26860774249989006, 0.11403745043357047, 0.028834324548631756, 0.12081480174802631, 0.23159299788799856, 0.16330312628846042, 0.29023514177866255, 0.33134309629896364, 0.08348450453318312, 0.33885307569001794, 0.5823422963507998], "epoch": 8, "n_parameters": 41304416}
{"train_lr": 4.999999999999505e-05, "train_class_error": 39.734917310625065, "train_loss": 12.278985717419962, "train_loss_ce": 0.6898207789584919, "train_loss_bbox": 0.42529797959678434, "train_loss_giou": 0.8755637287992781, "train_loss_ce_0": 0.7516789705800897, "train_loss_bbox_0": 0.4894687028593577, "train_loss_giou_0": 0.9551739944551376, "train_loss_ce_1": 0.7240925514440018, "train_loss_bbox_1": 0.44545651966952216, "train_loss_giou_1": 0.9029501408590511, "train_loss_ce_2": 0.7074935444523283, "train_loss_bbox_2": 0.4324937857604325, "train_loss_giou_2": 0.8866652173914537, "train_loss_ce_3": 0.6972217718380547, "train_loss_bbox_3": 0.4260816795986409, "train_loss_giou_3": 0.8788636519492056, "train_loss_ce_4": 0.6889542302601153, "train_loss_bbox_4": 0.42550541592341723, "train_loss_giou_4": 0.876203043141557, "train_loss_ce_unscaled": 0.6898207789584919, "train_class_error_unscaled": 39.734917310625065, "train_loss_bbox_unscaled": 0.085059595932459, "train_loss_giou_unscaled": 0.43778186439963906, "train_cardinality_error_unscaled": 11.649881636794047, "train_loss_ce_0_unscaled": 0.7516789705800897, "train_loss_bbox_0_unscaled": 0.09789374057993439, "train_loss_giou_0_unscaled": 0.4775869972275688, "train_cardinality_error_0_unscaled": 12.372505918160298, "train_loss_ce_1_unscaled": 0.7240925514440018, "train_loss_bbox_1_unscaled": 0.08909130396650859, "train_loss_giou_1_unscaled": 0.45147507042952556, "train_cardinality_error_1_unscaled": 12.148452823807913, "train_loss_ce_2_unscaled": 0.7074935444523283, "train_loss_bbox_2_unscaled": 0.08649875711414069, "train_loss_giou_2_unscaled": 0.4433326086957268, "train_cardinality_error_2_unscaled": 11.825642543118025, "train_loss_ce_3_unscaled": 0.6972217718380547, "train_loss_bbox_3_unscaled": 0.08521633588273984, "train_loss_giou_3_unscaled": 0.4394318259746028, "train_cardinality_error_3_unscaled": 11.614051403449443, "train_loss_ce_4_unscaled": 0.6889542302601153, "train_loss_bbox_4_unscaled": 0.08510108318458266, "train_loss_giou_4_unscaled": 0.4381015215707785, "train_cardinality_error_4_unscaled": 11.461202231991884, "test_class_error": 32.61011337890625, "test_loss": 11.960709329223633, "test_loss_ce": 0.6968697217941284, "test_loss_bbox": 0.38068525898456573, "test_loss_giou": 0.8610105731964112, "test_loss_ce_0": 0.7570200546741486, "test_loss_bbox_0": 0.43894723320007323, "test_loss_giou_0": 0.9500584963798523, "test_loss_ce_1": 0.7317454480648041, "test_loss_bbox_1": 0.3966424003601074, "test_loss_giou_1": 0.8925757704257965, "test_loss_ce_2": 0.7142166094779968, "test_loss_bbox_2": 0.3824551810979843, "test_loss_giou_2": 0.8732543040752411, "test_loss_ce_3": 0.7049571887969971, "test_loss_bbox_3": 0.3773559030771256, "test_loss_giou_3": 0.8652140686988831, "test_loss_ce_4": 0.6959631217002868, "test_loss_bbox_4": 0.3804144969701767, "test_loss_giou_4": 0.8613234844207763, "test_loss_ce_unscaled": 0.6968697217941284, "test_class_error_unscaled": 32.61011337890625, "test_loss_bbox_unscaled": 0.07613705171942711, "test_loss_giou_unscaled": 0.4305052865982056, "test_cardinality_error_unscaled": 15.9754, "test_loss_ce_0_unscaled": 0.7570200546741486, "test_loss_bbox_0_unscaled": 0.08778944677114486, "test_loss_giou_0_unscaled": 0.47502924818992615, "test_cardinality_error_0_unscaled": 19.907, "test_loss_ce_1_unscaled": 0.7317454480648041, "test_loss_bbox_1_unscaled": 0.07932848011851311, "test_loss_giou_1_unscaled": 0.44628788521289825, "test_cardinality_error_1_unscaled": 18.8722, "test_loss_ce_2_unscaled": 0.7142166094779968, "test_loss_bbox_2_unscaled": 0.07649103620648384, "test_loss_giou_2_unscaled": 0.43662715203762054, "test_cardinality_error_2_unscaled": 17.9062, "test_loss_ce_3_unscaled": 0.7049571887969971, "test_loss_bbox_3_unscaled": 0.07547118062973023, "test_loss_giou_3_unscaled": 0.43260703434944153, "test_cardinality_error_3_unscaled": 17.6684, "test_loss_ce_4_unscaled": 0.6959631217002868, "test_loss_bbox_4_unscaled": 0.07608289943933487, "test_loss_giou_4_unscaled": 0.43066174221038817, "test_cardinality_error_4_unscaled": 16.533, "test_coco_eval_bbox": [0.1545323687321915, 0.30186007803617554, 0.1436177932746261, 0.040421242199440155, 0.14952468099906527, 0.26076559494342066, 0.18248739299199632, 0.31243278698759397, 0.35516891541890416, 0.1020855398617376, 0.3724374665823224, 0.5917364234541341], "epoch": 9, "n_parameters": 41304416}



### Decision: Applied!


## 2. Efficient Attention

reference: https://openaccess.thecvf.com/content/WACV2021/papers/Shen_Efficient_Attention_Attention_With_Linear_Complexities_WACV_2021_paper.pdf

'
q = softmax(q, dim=2)
k = softmax(k, dim=2)
global_context = torch.bmm(k, v.transpose(1,2))
attn_output = torch.bmm(global_context.transpose(1, 2), q)
attn_output = attn_output.transpose(0, 1).contiguous().view(tgt_len, bsz, out_dim)
attn_output = linear(attn_output, out_proj_weight, out_proj_bias)
'

Compare with DeTr

DeTr: Epoch 0:"train_lr": 9.999999999999342e-05, "train_class_error": 89.00132779228738, "train_loss": 25.428831253216895, "train_loss_bbox": 1.141616935950595, "train_loss_bbox_0": 1.1871701720376293, "train_loss_bbox_1": 1.1554074858948267, "train_loss_bbox_2": 1.1439687113450978, "train_loss_bbox_3": 1.137943878802128, "train_loss_bbox_4": 1.1363896374385078, "train_loss_ce": 1.5075451776998126, "train_loss_ce_0": 1.5827832080391577, "train_loss_ce_1": 1.545520452064869, "train_loss_ce_2": 1.5272149658112815, "train_loss_ce_3": 1.5174654086656643, "train_loss_ce_4": 1.512690750325655, "train_loss_giou": 1.5496716783805327, "train_loss_giou_0": 1.5780433469907547, "train_loss_giou_1": 1.559824980988905, "train_loss_giou_2": 1.5517085842884981, "train_loss_giou_3": 1.5462578174807293, "train_loss_giou_4": 1.5476080747200298, "train_cardinality_error_unscaled": 7.935445413961039, "train_cardinality_error_0_unscaled": 7.70012344426407, "train_cardinality_error_1_unscaled": 7.736556412337662, "train_cardinality_error_2_unscaled": 7.717244994588745, "train_cardinality_error_3_unscaled": 7.795522186147186, "train_cardinality_error_4_unscaled": 7.856246617965368, "train_class_error_unscaled": 89.00132779228738, "train_loss_bbox_unscaled": 0.2283233871030343, "train_loss_bbox_0_unscaled": 0.23743403444542385, "train_loss_bbox_1_unscaled": 0.2310814970249544, "train_loss_bbox_2_unscaled": 0.2287937422762766, "train_loss_bbox_3_unscaled": 0.22758877592249996, "train_loss_bbox_4_unscaled": 0.22727792757236726, "train_loss_ce_unscaled": 1.5075451776998126, "train_loss_ce_0_unscaled": 1.5827832080391577, "train_loss_ce_1_unscaled": 1.545520452064869, "train_loss_ce_2_unscaled": 1.5272149658112815, "train_loss_ce_3_unscaled": 1.5174654086656643, "train_loss_ce_4_unscaled": 1.512690750325655, "train_loss_giou_unscaled": 0.7748358391902663, "train_loss_giou_0_unscaled": 0.7890216734953773, "train_loss_giou_1_unscaled": 0.7799124904944525, "train_loss_giou_2_unscaled": 0.7758542921442491, "train_loss_giou_3_unscaled": 0.7731289087403647, "train_loss_giou_4_unscaled": 0.7738040373600149, "test_class_error": 80.61580662818471, "test_loss": 28.39839132272514, "test_loss_bbox": 1.1101688678097572, "test_loss_bbox_0": 2.0522844032117518, "test_loss_bbox_1": 1.7690094071588698, "test_loss_bbox_2": 1.4350026625736503, "test_loss_bbox_3": 1.311189791958803, "test_loss_bbox_4": 1.1831550450082038, "test_loss_ce": 1.370138221865247, "test_loss_ce_0": 1.4795395280145536, "test_loss_ce_1": 1.463806616272896, "test_loss_ce_2": 1.4175632497307602, "test_loss_ce_3": 1.3968758446395777, "test_loss_ce_4": 1.383345760737255, "test_loss_giou": 1.5733277395272711, "test_loss_giou_0": 2.2133696329821446, "test_loss_giou_1": 1.9855036074948158, "test_loss_giou_2": 1.8301344411388325, "test_loss_giou_3": 1.7539237532646033, "test_loss_giou_4": 1.6700529771245969, "test_cardinality_error_unscaled": 13.492834394904458, "test_cardinality_error_0_unscaled": 18.508757961783438, "test_cardinality_error_1_unscaled": 19.818471337579616, "test_cardinality_error_2_unscaled": 17.193869426751593, "test_cardinality_error_3_unscaled": 15.385350318471337, "test_cardinality_error_4_unscaled": 12.799164012738853, "test_class_error_unscaled": 80.61580662818471, "test_loss_bbox_unscaled": 0.2220337728785861, "test_loss_bbox_0_unscaled": 0.41045688007287917, "test_loss_bbox_1_unscaled": 0.3538018821910688, "test_loss_bbox_2_unscaled": 0.28700053245778295, "test_loss_bbox_3_unscaled": 0.26223795865751376, "test_loss_bbox_4_unscaled": 0.23663100913451734, "test_loss_ce_unscaled": 1.370138221865247, "test_loss_ce_0_unscaled": 1.4795395280145536, "test_loss_ce_1_unscaled": 1.463806616272896, "test_loss_ce_2_unscaled": 1.4175632497307602, "test_loss_ce_3_unscaled": 1.3968758446395777, "test_loss_ce_4_unscaled": 1.383345760737255, "test_loss_giou_unscaled": 0.7866638697636356, "test_loss_giou_0_unscaled": 1.1066848164910723, "test_loss_giou_1_unscaled": 0.9927518037474079, "test_loss_giou_2_unscaled": 0.9150672205694163, "test_loss_giou_3_unscaled": 0.8769618766323016, "test_loss_giou_4_unscaled": 0.8350264885622984, "test_coco_eval_bbox": [0.0025538420077072395, 0.00785953672669776, 0.0012764198464959857, 0.002263049889529184, 0.0017684669320112308, 0.003754754519605244, 0.01362671087598188, 0.03070460682888716, 0.05339734524863692, 0.0036621445231624665, 0.028275972607074262, 0.09866316678023505], "n_parameters": 41302368

Mine: Epoch 0:

Decision: 

## 3. Eigendecomposition for attention_weight

'
weight_U, weight_S, weight_V = torch.svd(attn_output_weights)
weight_VH = weight_V.permute((1,0))
weight_S_obj = torch.where(weight_S > weight_S.mean(), torch.zeros(weight_S.shape))
weight_S_ctx = weight_S - weight_S_obj
attn_output_weights_obj = torch.bmm(weight_U * weight_S_obj, weight_VH)
attn_output_weights_ctx = torch.bmm(weight_U * weight_S_ctx, weight_VH)
'

Compare with DeTr

DeTr: Epoch 0:"train_lr": 9.999999999999342e-05, "train_class_error": 89.00132779228738, "train_loss": 25.428831253216895, "train_loss_bbox": 1.141616935950595, "train_loss_bbox_0": 1.1871701720376293, "train_loss_bbox_1": 1.1554074858948267, "train_loss_bbox_2": 1.1439687113450978, "train_loss_bbox_3": 1.137943878802128, "train_loss_bbox_4": 1.1363896374385078, "train_loss_ce": 1.5075451776998126, "train_loss_ce_0": 1.5827832080391577, "train_loss_ce_1": 1.545520452064869, "train_loss_ce_2": 1.5272149658112815, "train_loss_ce_3": 1.5174654086656643, "train_loss_ce_4": 1.512690750325655, "train_loss_giou": 1.5496716783805327, "train_loss_giou_0": 1.5780433469907547, "train_loss_giou_1": 1.559824980988905, "train_loss_giou_2": 1.5517085842884981, "train_loss_giou_3": 1.5462578174807293, "train_loss_giou_4": 1.5476080747200298, "train_cardinality_error_unscaled": 7.935445413961039, "train_cardinality_error_0_unscaled": 7.70012344426407, "train_cardinality_error_1_unscaled": 7.736556412337662, "train_cardinality_error_2_unscaled": 7.717244994588745, "train_cardinality_error_3_unscaled": 7.795522186147186, "train_cardinality_error_4_unscaled": 7.856246617965368, "train_class_error_unscaled": 89.00132779228738, "train_loss_bbox_unscaled": 0.2283233871030343, "train_loss_bbox_0_unscaled": 0.23743403444542385, "train_loss_bbox_1_unscaled": 0.2310814970249544, "train_loss_bbox_2_unscaled": 0.2287937422762766, "train_loss_bbox_3_unscaled": 0.22758877592249996, "train_loss_bbox_4_unscaled": 0.22727792757236726, "train_loss_ce_unscaled": 1.5075451776998126, "train_loss_ce_0_unscaled": 1.5827832080391577, "train_loss_ce_1_unscaled": 1.545520452064869, "train_loss_ce_2_unscaled": 1.5272149658112815, "train_loss_ce_3_unscaled": 1.5174654086656643, "train_loss_ce_4_unscaled": 1.512690750325655, "train_loss_giou_unscaled": 0.7748358391902663, "train_loss_giou_0_unscaled": 0.7890216734953773, "train_loss_giou_1_unscaled": 0.7799124904944525, "train_loss_giou_2_unscaled": 0.7758542921442491, "train_loss_giou_3_unscaled": 0.7731289087403647, "train_loss_giou_4_unscaled": 0.7738040373600149, "test_class_error": 80.61580662818471, "test_loss": 28.39839132272514, "test_loss_bbox": 1.1101688678097572, "test_loss_bbox_0": 2.0522844032117518, "test_loss_bbox_1": 1.7690094071588698, "test_loss_bbox_2": 1.4350026625736503, "test_loss_bbox_3": 1.311189791958803, "test_loss_bbox_4": 1.1831550450082038, "test_loss_ce": 1.370138221865247, "test_loss_ce_0": 1.4795395280145536, "test_loss_ce_1": 1.463806616272896, "test_loss_ce_2": 1.4175632497307602, "test_loss_ce_3": 1.3968758446395777, "test_loss_ce_4": 1.383345760737255, "test_loss_giou": 1.5733277395272711, "test_loss_giou_0": 2.2133696329821446, "test_loss_giou_1": 1.9855036074948158, "test_loss_giou_2": 1.8301344411388325, "test_loss_giou_3": 1.7539237532646033, "test_loss_giou_4": 1.6700529771245969, "test_cardinality_error_unscaled": 13.492834394904458, "test_cardinality_error_0_unscaled": 18.508757961783438, "test_cardinality_error_1_unscaled": 19.818471337579616, "test_cardinality_error_2_unscaled": 17.193869426751593, "test_cardinality_error_3_unscaled": 15.385350318471337, "test_cardinality_error_4_unscaled": 12.799164012738853, "test_class_error_unscaled": 80.61580662818471, "test_loss_bbox_unscaled": 0.2220337728785861, "test_loss_bbox_0_unscaled": 0.41045688007287917, "test_loss_bbox_1_unscaled": 0.3538018821910688, "test_loss_bbox_2_unscaled": 0.28700053245778295, "test_loss_bbox_3_unscaled": 0.26223795865751376, "test_loss_bbox_4_unscaled": 0.23663100913451734, "test_loss_ce_unscaled": 1.370138221865247, "test_loss_ce_0_unscaled": 1.4795395280145536, "test_loss_ce_1_unscaled": 1.463806616272896, "test_loss_ce_2_unscaled": 1.4175632497307602, "test_loss_ce_3_unscaled": 1.3968758446395777, "test_loss_ce_4_unscaled": 1.383345760737255, "test_loss_giou_unscaled": 0.7866638697636356, "test_loss_giou_0_unscaled": 1.1066848164910723, "test_loss_giou_1_unscaled": 0.9927518037474079, "test_loss_giou_2_unscaled": 0.9150672205694163, "test_loss_giou_3_unscaled": 0.8769618766323016, "test_loss_giou_4_unscaled": 0.8350264885622984, "test_coco_eval_bbox": [0.0025538420077072395, 0.00785953672669776, 0.0012764198464959857, 0.002263049889529184, 0.0017684669320112308, 0.003754754519605244, 0.01362671087598188, 0.03070460682888716, 0.05339734524863692, 0.0036621445231624665, 0.028275972607074262, 0.09866316678023505], "n_parameters": 41302368

Mine: Epoch 0:

Decision: 


